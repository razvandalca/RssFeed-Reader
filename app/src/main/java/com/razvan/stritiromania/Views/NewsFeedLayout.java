package com.razvan.stritiromania.Views;import android.content.Context;import android.util.AttributeSet;import android.util.Log;import android.view.View;import android.widget.ListView;import android.widget.ProgressBar;import android.widget.RelativeLayout;import android.widget.TextView;import com.einmalfel.earl.Item;import com.google.android.gms.ads.AdRequest;import com.google.android.gms.ads.AdView;import com.razvan.stritiromania.Activities.NewsFeedActivity;import com.razvan.stritiromania.Pojos.Interfaces.OnChangeListener;import com.razvan.stritiromania.Pojos.Models.NewsFeedModel;import com.razvan.stritiromania.R;import com.razvan.stritiromania.Views.Adapters.NewsFeedAdapter;/** * Created by Razvan'S PC on 19.03.2016. */public class NewsFeedLayout extends RelativeLayout implements View.OnClickListener,OnChangeListener {    private String TAG="NewsFeedLayout";    private ListView newsFeedListView;    private NewsFeedModel rootModel;    private NewsFeedAdapter newsFeedAdapter;    private NewsFeedActivity context;    private ProgressBar loadingBar;    private AdView mAdView;    private AdRequest adRequest;    private TextView noInternet;    public interface ViewListener{        public void onShareClicked(String URL,String title);        public void onFavoriteClicked(Item item);        public void onOpenCliked(String URL);    }    private ViewListener viewListener;    public void setViewListener(ViewListener viewListener)    {        this.viewListener = viewListener;    }    public NewsFeedLayout(Context context) {        super(context);    }    public NewsFeedLayout(Context context, AttributeSet attrs) {        super(context, attrs);    }    public NewsFeedLayout(Context context, AttributeSet attrs, int defStyleAttr) {        super(context, attrs, defStyleAttr);    }    @Override    protected void onFinishInflate() {        super.onFinishInflate();        newsFeedListView= (ListView) findViewById(R.id.listView);        noInternet= (TextView) findViewById(R.id.internetConnectionBar);        newsFeedListView.setEmptyView(loadingBar);        loadingBar= (ProgressBar) findViewById(R.id.loadingBar);        mAdView = (AdView) findViewById(R.id.adView);        adRequest = new AdRequest.Builder().build();        newsFeedListView.setEmptyView(loadingBar);//        if(!isConected()){//            noInternet.setVisibility(VISIBLE);//        }        //        newsFeedAdapter = new NewsFeedAdapter(rootModel.getItemsList(), context);//        newsFeedListView.setAdapter(newsFeedAdapter);        setOnClickListener(this);    }    @Override    public void onChange() {        if(newsFeedAdapter!=null){            newsFeedAdapter.notifyDataSetChanged();            Log.e(TAG, "onChange:1 ");        }else{            Log.e(TAG, "onChange:2 ");            newsFeedAdapter = new NewsFeedAdapter(rootModel.getItemsList(), context,viewListener);            context.runOnUiThread(new Runnable() {                @Override                public void run() {                    Log.e(TAG, "run: ON UI THREAD"+newsFeedListView );                    newsFeedListView.setAdapter(newsFeedAdapter);                    mAdView.loadAd(adRequest);                }            });        }    }    @Override    public void onClick(View v) {    }    public void setRootModel(NewsFeedModel rootModel) {        this.rootModel = rootModel;    }    public void setContext(NewsFeedActivity context) {        this.context = context;    }    public TextView getNoInternet() {        return noInternet;    }}